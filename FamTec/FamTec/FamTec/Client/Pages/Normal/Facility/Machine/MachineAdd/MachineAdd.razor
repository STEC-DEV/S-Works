@page "/facility/machine/add"
@using FamTec.Client.Pages.CommonComponents
@using FamTec.Client.Pages.Normal.Facility.Machine.Components
@using FamTec.Shared.Client.DTO.Normal.Facility
@using FamTec.Shared.Client.DTO.Normal.Location
@using FamTec.Shared.Server.DTO

<div class="add-container">
    <InfoCard  Facility="@Facility" />
    <div class="btns">
        <Button Width=true Type=0 Name="등록" OnClick="@OnAdd" />
        <Button Width=true Type=1 Name="나가기"/>
    </div>
</div>


@code {
    FacilityDetailDTO Facility = new FacilityDetailDTO();
    List<RoomDTO> Rooms;

    protected override async Task OnInitializedAsync()
    {
        await OnLoadRoom();

    }


    //공간 정보 전체 조회
    private async Task OnLoadRoom()
    {
        ResponseList<RoomDTO> resRooms = await apiManager.GetListAsync<RoomDTO>("/Room/sign/GetAllRoomList");
        if(resRooms.code != 200)
        {
            await JS.InvokeVoidAsync("alert", "공간정보 조회 실패");
            return;
        }
        Rooms = resRooms.data;

    }

    //등록
    private async Task OnAdd()
    {
        ResponseUnit<FacilityDetailDTO> resFac = await apiManager.PostAsync<FacilityDetailDTO>("MachineFacility/sign/AddMachineFacility", Facility);
    }
}
